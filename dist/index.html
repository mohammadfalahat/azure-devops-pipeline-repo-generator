<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate pipeline</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="ui.js"></script>
</head>
<body>
  <main class="wrapper">
    <header>
      <div class="header-main">
        <img src="images/icon.svg" class="logo" alt="Extension icon" />
        <div>
          <h1>Generate pipeline</h1>
          <p id="branch-label">Loading branch context...</p>
        </div>
      </div>
    </header>

    <section class="panel" id="pipeline-section">
      <p class="hint">
        Fill the fields below, then generate the pipeline. The generator will push the template and
        register the pipeline automatically.
      </p>
      <form id="pipeline-form">
        <div class="field">
          <label for="branch">Selected branch</label>
          <input id="branch" name="branch" disabled />
          <small>Captured from the branch list action. To change it, reopen the generator from the desired branch.</small>
        </div>
        <div class="field">
          <label for="personalAccessToken">Access token override (optional)</label>
          <div class="inline-input">
            <input
              id="personalAccessToken"
              name="personalAccessToken"
              type="password"
              autocomplete="off"
              placeholder="Enter a PAT with the needed scopes"
            />
            <button type="button" class="secondary" id="clearPat">Clear</button>
          </div>
          <label class="checkbox-inline">
            <input type="checkbox" id="rememberPat" /> Remember this token on this device
          </label>
          <small>
            Leave blank to use the access token supplied by Azure DevOps. Provide a Personal Access Token if you need broader
            permissions (for example, pipeline creation) and optionally store it locally.
          </small>
        </div>
        <div class="field">
          <label for="pool">Pool</label>
          <select id="pool" name="pool" required>
            <option value="PublishDockerAgent" selected>PublishDockerAgent</option>
            <option value="Default">Default</option>
          </select>
          <small>Use the build pool that will run the generated pipeline.</small>
        </div>
        <div class="field">
          <label for="service">Service name</label>
          <input id="service" name="service" required />
          <small>Lowercase identifier for the service being deployed. Auto-filled from the repository name when available.</small>
        </div>
        <div class="field">
          <label for="environment">Environment</label>
          <select id="environment" name="environment">
            <option value="dev">dev</option>
            <option value="demo" selected>demo</option>
            <option value="qa">qa</option>
            <option value="pro">pro</option>
          </select>
          <small>Auto-detected from the branch name when possible. You can still pick a different environment.</small>
        </div>
        <div class="field">
          <label for="dockerfileDir">Dockerfile directory</label>
            <input id="dockerfileDir" name="dockerfileDir" value="**" required />
          <small>Enter the relative folder that holds your Dockerfile (for example: . or services/api). Override the default if auto-detection is unavailable.</small>
        </div>
        <div class="field">
          <label for="repositoryAddress">Container registry URL</label>
          <input id="repositoryAddress" name="repositoryAddress" value="registry.buluttakin.com" required />
          <small>Base registry address used by the generated pipeline template.</small>
        </div>
        <div class="field">
          <label for="containerRegistryService">Container registry service</label>
          <select id="containerRegistryService" name="containerRegistryService" required>
            <option value="BulutReg" selected>BulutReg</option>
            <option value="DockerReg">DockerReg</option>
          </select>
          <small>Azure DevOps service connection that provides credentials for the registry address above.</small>
        </div>
        <div class="field">
          <label for="komodoServer">Komodo server</label>
          <select id="komodoServer" name="komodoServer">
            <option value="DEMO-192.168.62.91">DEMO-192.168.62.91</option>
            <option value="Development-192.168.62.19">Development-192.168.62.19</option>
            <option value="QA-192.168.62.153">QA-192.168.62.153</option>
            <option value="Production-31.7.65.195">Production-31.7.65.195</option>
          </select>
          <small>Auto-adjusted when you change the environment. Pick another host only if you need a different target.</small>
        </div>
        <div class="field">
          <label for="targetRepo">Target repository name</label>
          <input id="targetRepo" name="targetRepo" readonly disabled />
          <small>Auto-generated from the project name using the exact casing (for example: ProjectName_Azure_DevOps). The extension will create or reuse this repository.</small>
        </div>
        <button type="submit" class="primary">Create repository and pipeline</button>
      </form>
      <div id="status" role="status" aria-live="polite"></div>
    </section>
  </main>
</body>
</html>
